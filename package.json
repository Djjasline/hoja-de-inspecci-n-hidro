import { useState, useRef } from "react";
import jsPDF from "jspdf";
import autoTable from "jspdf-autotable";
import SignatureCanvas from "react-signature-canvas";

// Rutas de imágenes en /public
const LOGO_PATH = "/astap-logo.jpg";
const EQUIPO_IMG_PATH = "/estado-equipo.png";

const secciones = [
  {
    id: "sec1",
    titulo:
      "1. PRUEBAS DE ENCENDIDO DEL EQUIPO Y FUNCIONAMIENTO DE SUS SISTEMAS, PREVIOS AL SERVICIO",
    items: [
      { codigo: "1.1", texto: "Prueba de encendido general del equipo" },
      {
        codigo: "1.2",
        texto: "Verificación de funcionamiento de controles principales",
      },
      { codigo: "1.3", texto: "Revisión de alarmas o mensajes de fallo" },
    ],
  },
  {
    id: "secA",
    titulo:
      "2. EVALUACIÓN DEL ESTADO DE LOS COMPONENTES O ESTADO DE LOS SISTEMAS DEL MÓDULO VACTOR – A) SISTEMA HIDRÁULICO (ACEITES)",
    items: [
      {
        codigo: "A.1",
        texto:
          "Fugas de aceite hidráulico (mangueras - acoples - bancos)",
      },
      { codigo: "A.2", texto: "Nivel de aceite del soplador" },
      { codigo: "A.3", texto: "Nivel de aceite hidráulico" },
      {
        codigo: "A.4",
        texto: "Nivel de aceite en la caja de transferencia",
      },
      {
        codigo: "A.5",
        texto:
          "Inspección del manómetro de filtro hidráulico de retorno (verde, amarillo, rojo)",
      },
      {
        codigo: "A.6",
        texto:
          "Inspección del filtro hidráulico de retorno, presenta fugas o daños",
      },
      {
        codigo: "A.7",
        texto:
          "Inspección de los filtros de succión del tanque hidráulico (opcional)",
      },
      {
        codigo: "A.8",
        texto:
          "Estado de los cilindros hidráulicos, presenta fugas o daños",
      },
      {
        codigo: "A.9",
        texto:
          "Evaluación del estado de los tapones de drenaje de lubricantes",
      },
      {
        codigo: "A.10",
        texto:
          "Evaluación de bancos hidráulicos, presentan fugas o daños",
      },
    ],
  },
  {
    id: "secB",
    titulo:
      "2. EVALUACIÓN DEL ESTADO DE LOS COMPONENTES O ESTADO DE LOS SISTEMAS DEL MÓDULO VACTOR – B) SISTEMA HIDRÁULICO (AGUA)",
    items: [
      {
        codigo: "B.1",
        texto:
          'Inspección del estado de los filtros malla para agua de 2" y 3"',
      },
      {
        codigo: "B.2",
        texto:
          "Estado de los empaques de la tapa de los filtros de agua",
      },
      {
        codigo: "B.3",
        texto:
          "Inspección de fugas de agua (mangueras - acoples)",
      },
      {
        codigo: "B.4",
        texto:
          "Inspección de la válvula de alivio de la pistola (opcional de 700 PSI)",
      },
      {
        codigo: "B.5",
        texto:
          "Inspección de golpes y fugas de agua en el tanque de aluminio",
      },
      {
        codigo: "B.6",
        texto:
          "Inspección del medidor de nivel del tanque, ¿se visualizan sus bolitas?",
      },
      {
        codigo: "B.7",
        texto:
          'Inspección del sistema de tapón de expansión de 2" de tanques de aluminio',
      },
      {
        codigo: "B.8",
        texto:
          "Inspección del sistema de drenaje de la bomba Rodder (opcional)",
      },
      {
        codigo: "B.9",
        texto:
          'Estado de válvulas checks internas de la bomba de 2" y de 3"',
      },
      {
        codigo: "B.10",
        texto:
          "Estado de los manómetros de presión (opcional)",
      },
      {
        codigo: "B.11",
        texto:
          "Inspección del estado del carrete de manguera y manguera guía",
      },
      { codigo: "B.12", texto: "Soporte del carrete, ¿está flojo?" },
      {
        codigo: "B.13",
        texto:
          "Inspección del codo giratorio del carrete, superior e inferior, ¿presenta fugas?",
      },
      {
        codigo: "B.14",
        texto:
          "Inspección de sistema de trinquete, seguros y cilindros neumáticos, ¿se activan?",
      },
      {
        codigo: "B.15",
        texto:
          "Inspección de la válvula de alivio de bomba de agua (opcional)",
      },
      { codigo: "B.16", texto: "Inspección de válvulas de 1\"" },
      { codigo: "B.17", texto: "Inspección de válvulas de 3/4\"" },
      { codigo: "B.18", texto: "Inspección de válvulas de 1/2\"" },
      {
        codigo: "B.19",
        texto:
          "Estado de las boquillas, ¿se les da mantenimiento/conservación?",
      },
    ],
  },
  {
    id: "secC",
    titulo: "C) SISTEMA ELÉCTRICO Y ELECTRÓNICO",
    items: [
      {
        codigo: "C.1",
        texto:
          "Inspección de funciones de tablero frontal, ¿se mantiene limpio?",
      },
      {
        codigo: "C.2",
        texto:
          "Evaluar funcionamiento de tablero de control interno en cabina",
      },
      {
        codigo: "C.3",
        texto:
          "Inspección del estado de control remoto y estado de su puerto de carga",
      },
      {
        codigo: "C.4",
        texto:
          "Inspección del estado de las electroválvulas de los bancos de control",
      },
      { codigo: "C.5", texto: "Presencia de humedad en sus componentes" },
      {
        codigo: "C.6",
        texto:
          "Revisión de luces estrobo, flechas y accesorios externos",
      },
    ],
  },
  {
    id: "secD",
    titulo: "D) SISTEMA DE SUCCIÓN",
    items: [
      {
        codigo: "D.1",
        texto:
          "Inspección de los sellos en el tanque de desperdicios, frontal y posterior",
      },
      {
        codigo: "D.2",
        texto:
          "Estado interno del tanque de desechos, canastillas, esferas y deflectores",
      },
      {
        codigo: "D.3",
        texto:
          "Inspección de los microfiltros de succión (3)",
      },
      {
        codigo: "D.4",
        texto:
          "Inspección del tapón de drenaje del filtro de succión",
      },
      {
        codigo: "D.5",
        texto:
          "Estado físico de las mangueras de succión",
      },
      {
        codigo: "D.6",
        texto:
          "Seguros de compuerta del tanque de desechos",
      },
      {
        codigo: "D.7",
        texto:
          "Inspección del sistema de desfogue (válvula y actuador)",
      },
      {
        codigo: "D.8",
        texto:
          "Inspección de válvulas de alivio de presión Kunkle (3)",
      },
    ],
  },
];

export default function HojaInspeccionHidro() {
  const [formData, setFormData] = useState({
    referenciaContrato: "",
    descripcion: "",
    codInf: "",
    fechaInspeccion: "",
    ubicacion: "",
    cliente: "",
    tecnicoAstap: "",
    responsableCliente: "",
    estadoEquipo: "",
    observacionesGenerales: "",
    marca: "",
    modelo: "",
    numeroSerie: "",
    placa: "",
    horasModulo: "",
    horasChasis: "",
    anioModelo: "",
    vinChasis: "",
    kilometraje: "",
    elaboradoNombre: "",
    elaboradoCargo: "",
    elaboradoTelefono: "",
    elaboradoCorreo: "",
    autorizadoNombre: "",
    autorizadoCargo: "",
    autorizadoTelefono: "",
    autorizadoCorreo: "",
    items: {},
  });

  const [estadoEquipoMarks, setEstadoEquipoMarks] = useState([]);
  const sigAstapRef = useRef(null);
  const sigClienteRef = useRef(null);

  // ... (RESTO DEL COMPONENTE IGUAL AL QUE TE ENVIÉ ANTES:
  // handleHeaderChange, handleItemChange, handleEstadoEquipoClick,
  // handleGeneratePDF, y todo el JSX del return)
}
